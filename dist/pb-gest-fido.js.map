{"version":3,"sources":["pb-gest-fido.js"],"names":[],"mappings":";AACA,YAAY,CAAC;;;;;;IAEP,MAAM;AACE,WADR,MAAM,CACG,YAAY,EAAE;0BADvB,MAAM;;AAER,QAAI,CAAC,IAAI,GAAG,YAAY,CAAC;GAC1B;;eAHG,MAAM;;WAKH,mBAAG;AACR,aAAO,IAAI,CAAC,IAAI,CAAC;KAClB;;;WAEM,iBAAC,YAAY,EAAE;AACpB,UAAI,CAAC,IAAI,GAAG,YAAY,CAAC;AACzB,aAAO,IAAI,CAAC;KACb;;;WAEc,2BAAG;AAChB,aAAO;AACL,aAAK,EAAE,KAAK;AACZ,eAAO,EAAE,KAAK;OACf,CAAA;KACF;;;WAEY,yBAAG;AACd,aAAO;AACL,aAAK,EAAE,IAAI;AACX,eAAO,EAAE,KAAK;OACf,CAAA;KACF;;;WAEc,2BAAG;AAChB,aAAO;AACL,aAAK,EAAE,KAAK;AACZ,eAAO,EAAE,IAAI;OACd,CAAA;KACF;;;WAEM,iBAAC,QAAQ,EAAE;AAChB,UAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,EAAE;AACxC,eAAO,IAAI,CAAC,aAAa,EAAE,CAAC;OAC7B,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;AAClD,eAAO,IAAI,CAAC,eAAe,EAAE,CAAC;OAC/B,MAAM,IAAI,QAAQ,CAAC,WAAW,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;AAC9E,eAAO,IAAI,CAAC,eAAe,EAAE,CAAC;OAC/B,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;AAC/C,eAAO,IAAI,CAAC,eAAe,EAAE,CAAC;OAC/B,MAAM,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;AAC/C,eAAO,IAAI,CAAC,eAAe,EAAE,CAAC;OAC/B,MAAM,IAAI,CAAC,QAAQ,IAAI,CAAC,QAAQ,CAAC,WAAW,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,EAAE;AAC5E,eAAO,IAAI,CAAC,aAAa,EAAE,CAAC;OAC7B;;AAED,aAAO,IAAI,CAAC,aAAa,EAAE,CAAC;KAC7B;;;SAnDG,MAAM;;;AAsDZ,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,EAAE,CAAC,CAE7B,OAAO,CAAC,cAAc,EAAE,CAAC,IAAI,EAAE,UAAU,EAAE,EAAE;;AAE5C,WAAS,OAAO,CAAC,QAAQ,EAAE,YAAY,EAAE;AACvC,QAAI,QAAQ,GAAG,EAAE,CAAC,KAAK,EAAE;QACvB,IAAI,GAAG,IAAI,MAAM,CAAC,YAAY,CAAC;QAC/B,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;;AAEpC,QAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,KAAK,KAAK,KAAK,EAAE;AACzC,cAAQ,CAAC,MAAM,EAAE,CAAC;KACnB,MAAM,IAAI,QAAQ,CAAC,OAAO,KAAK,IAAI,EAAE;AACpC,cAAQ,CAAC,OAAO,CAAC,EAAC,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC;KACnC,MAAM;AACL,cAAQ,CAAC,OAAO,CAAC,EAAC,OAAO,EAAE,KAAK,EAAC,CAAC,CAAC;KACpC;;AAED,WAAO,QAAQ,CAAC,OAAO,CAAC;GACzB;;AAED,SAAO;AACL,WAAO,EAAE,OAAO;GACjB,CAAA;CACF,CAAC,CAAC,CAAC","file":"pb-gest-fido.js","sourcesContent":["/*! pb-gest-fido 0.1.4 - Copyright 2015 Palmabit <hello@palmabit.com> (http://www.palmabit.com) */\n'use strict';\n\nclass PbFido {\n  constructor (customerFido) {\n    this.fido = customerFido;\n  }\n\n  getFido() {\n    return this.fido;\n  }\n\n  setFido(customerFido) {\n    this.fido = customerFido;\n    return this;\n  }\n\n  responseInvalid() {\n    return {\n      valid: false,\n      warning: false\n    }\n  }\n\n  responseValid() {\n    return {\n      valid: true,\n      warning: false\n    }\n  }\n\n  responseWarning() {\n    return {\n      valid: false,\n      warning: true\n    }\n  }\n\n  isValid(document) {\n    if (!this.fido || this.fido.amount === 0) {\n      return this.responseValid();\n    } else if (this.fido.not_payed >= this.fido.amount) {\n      return this.responseInvalid();\n    } else if (document.total_price.total + this.fido.not_payed > this.fido.amount) {\n      return this.responseWarning();\n    } else if (this.fido.open >= this.fido.max_open) {\n      return this.responseWarning();\n    } else if (this.fido.days >= this.fido.max_days) {\n      return this.responseWarning();\n    } else if (!document || !document.total_price || !document.total_price.total) {\n      return this.responseValid();\n    }\n\n    return this.responseValid();\n  }\n}\n\nangular.module('pbGestFido', [])\n\n  .factory('DocumentFido', ['$q', function ($q) {\n\n    function isValid(document, customerFido) {\n      var deferred = $q.defer(),\n        fido = new PbFido(customerFido),\n        response = fido.isValid(document);\n\n      if (!response || response.valid === false) {\n        deferred.reject();\n      } else if (response.warning === true) {\n        deferred.resolve({warning: true});\n      } else {\n        deferred.resolve({warning: false});\n      }\n\n      return deferred.promise;\n    }\n\n    return {\n      isValid: isValid\n    }\n  }]);\n"]}